<!DOCTYPE html>
<html>
    <head>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/skeleton/2.0.4/skeleton.min.css" integrity="sha512-EZLkOqwILORob+p0BXZc+Vm3RgJBOe1Iq/0fiI7r/wJgzOFZMlsqTa29UEl6v6U6gsV4uIpsNZoV32YZqrCRCQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />
        <meta charset="UTF-8" />
        <title>Login | Teameet</title>
        <link rel="stylesheet" href="/globalstyle.css" />
        <style>
            #loginfailed{
                color: red;
                display: none;
                width: fit-content;
            }
            #loginfailed:hover{
                cursor: text;
            }
            input{
                margin-bottom: 20px;
            }
            header{
                margin-left: 20vw;
                margin-bottom: 10vh;
            }
            main{
                margin-left: 10vw;
            }
            input{
                font-size: large;
            }
        </style>
        <script>
            (function(){
                let params = new URLSearchParams(document.location.search);
                window.referer = decodeURI(params.get("ref"));
                fetch("/api/login").then(r => r.json()).then(res => {
                    if (res.status == 200) {
                        location.href = referer || "/";
                    }
                });
            })();
            function login() {
                fetch("/api/login", {
                    method: "POST",
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        email: document.querySelector("#email").value,
                        password: document.querySelector("#password").value
                    })
                }).then(r => r.json()).then(res => {
                    if (res.status == 200) {
                        location.href = referer || "/";
                    } else {
                        document.querySelector("#loginfailed").style.display = "block";
                    }
                });
            }
        </script>
    </head>
    <body>
        <header>
            <h1>login to your Teameet accout</h1>
        </header>
        <main>
            <form>
                <input id="email" placeholder="E-Mail" type="email" />
                <br />
                <input id="password" placeholder="Password" type="password" />
                <br />
                <button type="submit" onclick="login()">Log In</button>
                <p>
                    <span id="loginfailed">You typed in the wrong E-Mail or Password</span>
                </p>
            </form>
        </main>
        <script>
            document.addEventListener("submit", event => {
                event.preventDefault();
            });
        </script>
    </body>
</html>